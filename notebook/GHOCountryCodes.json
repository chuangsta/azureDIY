{
	"name": "GHOCountryCodes",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "azureDIY",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"70828842-41d8-4a35-b9a1-fc5b1ab48f9c": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"Country_Region": "Equatorial Guinea",
										"iso3": "GNQ"
									},
									{
										"Country_Region": "Libya",
										"iso3": "LBY"
									},
									{
										"Country_Region": "US",
										"iso3": "ASM"
									},
									{
										"Country_Region": "Haiti",
										"iso3": "HTI"
									},
									{
										"Country_Region": "Austria",
										"iso3": "AUT"
									},
									{
										"Country_Region": "France",
										"iso3": "PYF"
									},
									{
										"Country_Region": "Ecuador",
										"iso3": "ECU"
									},
									{
										"Country_Region": "Jamaica",
										"iso3": "JAM"
									},
									{
										"Country_Region": "Rwanda",
										"iso3": "RWA"
									},
									{
										"Country_Region": "Uzbekistan",
										"iso3": "UZB"
									},
									{
										"Country_Region": "Dominican Republic",
										"iso3": "DOM"
									},
									{
										"Country_Region": "Mexico",
										"iso3": "MEX"
									},
									{
										"Country_Region": "Liberia",
										"iso3": "LBR"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "BMU"
									},
									{
										"Country_Region": "Colombia",
										"iso3": "COL"
									},
									{
										"Country_Region": "Yemen",
										"iso3": "YEM"
									},
									{
										"Country_Region": "Gambia",
										"iso3": "GMB"
									},
									{
										"Country_Region": "Zimbabwe",
										"iso3": "ZWE"
									},
									{
										"Country_Region": "Slovenia",
										"iso3": "SVN"
									},
									{
										"Country_Region": "Suriname",
										"iso3": "SUR"
									},
									{
										"Country_Region": "Serbia",
										"iso3": "SRB"
									},
									{
										"Country_Region": "Bahamas",
										"iso3": "BHS"
									},
									{
										"Country_Region": "Slovakia",
										"iso3": "SVK"
									},
									{
										"Country_Region": "Russia",
										"iso3": "RUS"
									},
									{
										"Country_Region": "China",
										"iso3": "CHN"
									},
									{
										"Country_Region": "France",
										"iso3": "GLP"
									},
									{
										"Country_Region": "France",
										"iso3": "MYT"
									},
									{
										"Country_Region": "Italy",
										"iso3": "ITA"
									},
									{
										"Country_Region": "Liechtenstein",
										"iso3": "LIE"
									},
									{
										"Country_Region": "Madagascar",
										"iso3": "MDG"
									},
									{
										"Country_Region": "US",
										"iso3": "VIR"
									},
									{
										"Country_Region": "Dominica",
										"iso3": "DMA"
									},
									{
										"Country_Region": "Philippines",
										"iso3": "PHL"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "GBR"
									},
									{
										"Country_Region": "Gabon",
										"iso3": "GAB"
									},
									{
										"Country_Region": "Luxembourg",
										"iso3": "LUX"
									},
									{
										"Country_Region": "Qatar",
										"iso3": "QAT"
									},
									{
										"Country_Region": "Afghanistan",
										"iso3": "AFG"
									},
									{
										"Country_Region": "Barbados",
										"iso3": "BRB"
									},
									{
										"Country_Region": "Denmark",
										"iso3": "GRL"
									},
									{
										"Country_Region": "Tunisia",
										"iso3": "TUN"
									},
									{
										"Country_Region": "Holy See",
										"iso3": "VAT"
									},
									{
										"Country_Region": "MS Zaandam",
										"iso3": "null"
									},
									{
										"Country_Region": "Sri Lanka",
										"iso3": "LKA"
									},
									{
										"Country_Region": "China",
										"iso3": "MAC"
									},
									{
										"Country_Region": "Djibouti",
										"iso3": "DJI"
									},
									{
										"Country_Region": "Greece",
										"iso3": "GRC"
									},
									{
										"Country_Region": "Albania",
										"iso3": "ALB"
									},
									{
										"Country_Region": "Bosnia and Herzegovina",
										"iso3": "BIH"
									},
									{
										"Country_Region": "Saint Kitts and Nevis",
										"iso3": "KNA"
									},
									{
										"Country_Region": "Netherlands",
										"iso3": "SXM"
									},
									{
										"Country_Region": "Kuwait",
										"iso3": "KWT"
									},
									{
										"Country_Region": "Armenia",
										"iso3": "ARM"
									},
									{
										"Country_Region": "Cameroon",
										"iso3": "CMR"
									},
									{
										"Country_Region": "Brazil",
										"iso3": "BRA"
									},
									{
										"Country_Region": "India",
										"iso3": "IND"
									},
									{
										"Country_Region": "Japan",
										"iso3": "JPN"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "CYM"
									},
									{
										"Country_Region": "Malaysia",
										"iso3": "MYS"
									},
									{
										"Country_Region": "US",
										"iso3": "USA"
									},
									{
										"Country_Region": "Denmark",
										"iso3": "DNK"
									},
									{
										"Country_Region": "Ethiopia",
										"iso3": "ETH"
									},
									{
										"Country_Region": "Georgia",
										"iso3": "GEO"
									},
									{
										"Country_Region": "Nepal",
										"iso3": "NPL"
									},
									{
										"Country_Region": "Eritrea",
										"iso3": "ERI"
									},
									{
										"Country_Region": "Hungary",
										"iso3": "HUN"
									},
									{
										"Country_Region": "Niger",
										"iso3": "NER"
									},
									{
										"Country_Region": "Iceland",
										"iso3": "ISL"
									},
									{
										"Country_Region": "Papua New Guinea",
										"iso3": "PNG"
									},
									{
										"Country_Region": "Western Sahara",
										"iso3": "ESH"
									},
									{
										"Country_Region": "Fiji",
										"iso3": "FJI"
									},
									{
										"Country_Region": "Mongolia",
										"iso3": "MNG"
									},
									{
										"Country_Region": "Seychelles",
										"iso3": "SYC"
									},
									{
										"Country_Region": "Indonesia",
										"iso3": "IDN"
									},
									{
										"Country_Region": "Somalia",
										"iso3": "SOM"
									},
									{
										"Country_Region": "Cambodia",
										"iso3": "KHM"
									},
									{
										"Country_Region": "Kosovo",
										"iso3": "XKS"
									},
									{
										"Country_Region": "Nigeria",
										"iso3": "NGA"
									},
									{
										"Country_Region": "Solomon Islands",
										"iso3": "SLB"
									},
									{
										"Country_Region": "Cote d'Ivoire",
										"iso3": "CIV"
									},
									{
										"Country_Region": "Saint Vincent and the Grenadines",
										"iso3": "VCT"
									},
									{
										"Country_Region": "Tanzania",
										"iso3": "TZA"
									},
									{
										"Country_Region": "France",
										"iso3": "SPM"
									},
									{
										"Country_Region": "Germany",
										"iso3": "DEU"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "IMN"
									},
									{
										"Country_Region": "Ireland",
										"iso3": "IRL"
									},
									{
										"Country_Region": "Brunei",
										"iso3": "BRN"
									},
									{
										"Country_Region": "US",
										"iso3": "GUM"
									},
									{
										"Country_Region": "Ghana",
										"iso3": "GHA"
									},
									{
										"Country_Region": "Timor-Leste",
										"iso3": "TLS"
									},
									{
										"Country_Region": "Congo (Kinshasa)",
										"iso3": "COD"
									},
									{
										"Country_Region": "Poland",
										"iso3": "POL"
									},
									{
										"Country_Region": "Pakistan",
										"iso3": "PAK"
									},
									{
										"Country_Region": "Switzerland",
										"iso3": "CHE"
									},
									{
										"Country_Region": "France",
										"iso3": "GUF"
									},
									{
										"Country_Region": "Mali",
										"iso3": "MLI"
									},
									{
										"Country_Region": "West Bank and Gaza",
										"iso3": "PSE"
									},
									{
										"Country_Region": "Belize",
										"iso3": "BLZ"
									},
									{
										"Country_Region": "Venezuela",
										"iso3": "VEN"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "GIB"
									},
									{
										"Country_Region": "Central African Republic",
										"iso3": "CAF"
									},
									{
										"Country_Region": "Lesotho",
										"iso3": "LSO"
									},
									{
										"Country_Region": "Maldives",
										"iso3": "MDV"
									},
									{
										"Country_Region": "Marshall Islands",
										"iso3": "MHL"
									},
									{
										"Country_Region": "Chad",
										"iso3": "TCD"
									},
									{
										"Country_Region": "Jordan",
										"iso3": "JOR"
									},
									{
										"Country_Region": "Peru",
										"iso3": "PER"
									},
									{
										"Country_Region": "Namibia",
										"iso3": "NAM"
									},
									{
										"Country_Region": "North Macedonia",
										"iso3": "MKD"
									},
									{
										"Country_Region": "Spain",
										"iso3": "ESP"
									},
									{
										"Country_Region": "Trinidad and Tobago",
										"iso3": "TTO"
									},
									{
										"Country_Region": "Argentina",
										"iso3": "ARG"
									},
									{
										"Country_Region": "Sudan",
										"iso3": "SDN"
									},
									{
										"Country_Region": "Netherlands",
										"iso3": "CUW"
									},
									{
										"Country_Region": "United Arab Emirates",
										"iso3": "ARE"
									},
									{
										"Country_Region": "Netherlands",
										"iso3": "NLD"
									},
									{
										"Country_Region": "Belarus",
										"iso3": "BLR"
									},
									{
										"Country_Region": "South Africa",
										"iso3": "ZAF"
									},
									{
										"Country_Region": "Kazakhstan",
										"iso3": "KAZ"
									},
									{
										"Country_Region": "Mauritania",
										"iso3": "MRT"
									},
									{
										"Country_Region": "Ukraine",
										"iso3": "UKR"
									},
									{
										"Country_Region": "Bulgaria",
										"iso3": "BGR"
									},
									{
										"Country_Region": "Canada",
										"iso3": "CAN"
									},
									{
										"Country_Region": "Andorra",
										"iso3": "AND"
									},
									{
										"Country_Region": "Panama",
										"iso3": "PAN"
									},
									{
										"Country_Region": "Bahrain",
										"iso3": "BHR"
									},
									{
										"Country_Region": "Senegal",
										"iso3": "SEN"
									},
									{
										"Country_Region": "Korea, South",
										"iso3": "KOR"
									},
									{
										"Country_Region": "France",
										"iso3": "NCL"
									},
									{
										"Country_Region": "Turkey",
										"iso3": "TUR"
									},
									{
										"Country_Region": "France",
										"iso3": "WLF"
									},
									{
										"Country_Region": "Iran",
										"iso3": "IRN"
									},
									{
										"Country_Region": "Chile",
										"iso3": "CHL"
									},
									{
										"Country_Region": "Congo (Brazzaville)",
										"iso3": "COG"
									},
									{
										"Country_Region": "Denmark",
										"iso3": "FRO"
									},
									{
										"Country_Region": "Laos",
										"iso3": "LAO"
									},
									{
										"Country_Region": "Honduras",
										"iso3": "HND"
									},
									{
										"Country_Region": "Angola",
										"iso3": "AGO"
									},
									{
										"Country_Region": "Australia",
										"iso3": "AUS"
									},
									{
										"Country_Region": "Togo",
										"iso3": "TGO"
									},
									{
										"Country_Region": "US",
										"iso3": "MNP"
									},
									{
										"Country_Region": "Burma",
										"iso3": "MMR"
									},
									{
										"Country_Region": "France",
										"iso3": "MAF"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "MSR"
									},
									{
										"Country_Region": "Malawi",
										"iso3": "MWI"
									},
									{
										"Country_Region": "Samoa",
										"iso3": "WSM"
									},
									{
										"Country_Region": "Saint Lucia",
										"iso3": "LCA"
									},
									{
										"Country_Region": "Zambia",
										"iso3": "ZMB"
									},
									{
										"Country_Region": "Sierra Leone",
										"iso3": "SLE"
									},
									{
										"Country_Region": "France",
										"iso3": "BLM"
									},
									{
										"Country_Region": "Lithuania",
										"iso3": "LTU"
									},
									{
										"Country_Region": "Nicaragua",
										"iso3": "NIC"
									},
									{
										"Country_Region": "Sao Tome and Principe",
										"iso3": "STP"
									},
									{
										"Country_Region": "Saudi Arabia",
										"iso3": "SAU"
									},
									{
										"Country_Region": "Syria",
										"iso3": "SYR"
									},
									{
										"Country_Region": "Guinea-Bissau",
										"iso3": "GNB"
									},
									{
										"Country_Region": "Singapore",
										"iso3": "SGP"
									},
									{
										"Country_Region": "South Sudan",
										"iso3": "SSD"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "AIA"
									},
									{
										"Country_Region": "Botswana",
										"iso3": "BWA"
									},
									{
										"Country_Region": "Comoros",
										"iso3": "COM"
									},
									{
										"Country_Region": "Czechia",
										"iso3": "CZE"
									},
									{
										"Country_Region": "Bhutan",
										"iso3": "BTN"
									},
									{
										"Country_Region": "US",
										"iso3": "PRI"
									},
									{
										"Country_Region": "Kyrgyzstan",
										"iso3": "KGZ"
									},
									{
										"Country_Region": "Antigua and Barbuda",
										"iso3": "ATG"
									},
									{
										"Country_Region": "Eswatini",
										"iso3": "SWZ"
									},
									{
										"Country_Region": "Azerbaijan",
										"iso3": "AZE"
									},
									{
										"Country_Region": "Costa Rica",
										"iso3": "CRI"
									},
									{
										"Country_Region": "Moldova",
										"iso3": "MDA"
									},
									{
										"Country_Region": "Benin",
										"iso3": "BEN"
									},
									{
										"Country_Region": "New Zealand",
										"iso3": "NZL"
									},
									{
										"Country_Region": "El Salvador",
										"iso3": "SLV"
									},
									{
										"Country_Region": "Mozambique",
										"iso3": "MOZ"
									},
									{
										"Country_Region": "Romania",
										"iso3": "ROU"
									},
									{
										"Country_Region": "France",
										"iso3": "MTQ"
									},
									{
										"Country_Region": "Guyana",
										"iso3": "GUY"
									},
									{
										"Country_Region": "San Marino",
										"iso3": "SMR"
									},
									{
										"Country_Region": "Burkina Faso",
										"iso3": "BFA"
									},
									{
										"Country_Region": "Belgium",
										"iso3": "BEL"
									},
									{
										"Country_Region": "Oman",
										"iso3": "OMN"
									},
									{
										"Country_Region": "Paraguay",
										"iso3": "PRY"
									},
									{
										"Country_Region": "Norway",
										"iso3": "NOR"
									},
									{
										"Country_Region": "Grenada",
										"iso3": "GRD"
									},
									{
										"Country_Region": "China",
										"iso3": "HKG"
									},
									{
										"Country_Region": "Iraq",
										"iso3": "IRQ"
									},
									{
										"Country_Region": "Uganda",
										"iso3": "UGA"
									},
									{
										"Country_Region": "Micronesia",
										"iso3": "FSM"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "VGB"
									},
									{
										"Country_Region": "Palau",
										"iso3": "PLW"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "FLK"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "SHN"
									},
									{
										"Country_Region": "Netherlands",
										"iso3": "ABW"
									},
									{
										"Country_Region": "Portugal",
										"iso3": "PRT"
									},
									{
										"Country_Region": "Bangladesh",
										"iso3": "BGD"
									},
									{
										"Country_Region": "Guinea",
										"iso3": "GIN"
									},
									{
										"Country_Region": "Morocco",
										"iso3": "MAR"
									},
									{
										"Country_Region": "Croatia",
										"iso3": "HRV"
									},
									{
										"Country_Region": "Monaco",
										"iso3": "MCO"
									},
									{
										"Country_Region": "France",
										"iso3": "REU"
									},
									{
										"Country_Region": "Israel",
										"iso3": "ISR"
									},
									{
										"Country_Region": "Tajikistan",
										"iso3": "TJK"
									},
									{
										"Country_Region": "Burundi",
										"iso3": "BDI"
									},
									{
										"Country_Region": "Finland",
										"iso3": "FIN"
									},
									{
										"Country_Region": "Cuba",
										"iso3": "CUB"
									},
									{
										"Country_Region": "Lebanon",
										"iso3": "LBN"
									},
									{
										"Country_Region": "Sweden",
										"iso3": "SWE"
									},
									{
										"Country_Region": "Malta",
										"iso3": "MLT"
									},
									{
										"Country_Region": "Montenegro",
										"iso3": "MNE"
									},
									{
										"Country_Region": "Guatemala",
										"iso3": "GTM"
									},
									{
										"Country_Region": "France",
										"iso3": "FRA"
									},
									{
										"Country_Region": "Cabo Verde",
										"iso3": "CPV"
									},
									{
										"Country_Region": "Thailand",
										"iso3": "THA"
									},
									{
										"Country_Region": "Algeria",
										"iso3": "DZA"
									},
									{
										"Country_Region": "Vietnam",
										"iso3": "VNM"
									},
									{
										"Country_Region": "Cyprus",
										"iso3": "CYP"
									},
									{
										"Country_Region": "Uruguay",
										"iso3": "URY"
									},
									{
										"Country_Region": "Netherlands",
										"iso3": "BES"
									},
									{
										"Country_Region": "Mauritius",
										"iso3": "MUS"
									},
									{
										"Country_Region": "Kenya",
										"iso3": "KEN"
									},
									{
										"Country_Region": "Diamond Princess",
										"iso3": "null"
									},
									{
										"Country_Region": "Egypt",
										"iso3": "EGY"
									},
									{
										"Country_Region": "Estonia",
										"iso3": "EST"
									},
									{
										"Country_Region": "Latvia",
										"iso3": "LVA"
									},
									{
										"Country_Region": "Bolivia",
										"iso3": "BOL"
									},
									{
										"Country_Region": "Vanuatu",
										"iso3": "VUT"
									},
									{
										"Country_Region": "Taiwan*",
										"iso3": "TWN"
									},
									{
										"Country_Region": "United Kingdom",
										"iso3": "TCA"
									}
								],
								"schema": {
									"iso3": "string",
									"Country_Region": "string"
								}
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"iso3"
									],
									"seriesFieldKeys": [
										"iso3"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/9e5fd910-2fa6-4b1c-ad1a-596f02e9d94d/resourceGroups/azureDIY-RG-AUE/providers/Microsoft.Synapse/workspaces/azurediy-aue-sya/bigDataPools/azureDIY",
				"name": "azureDIY",
				"type": "Spark",
				"endpoint": "https://azurediy-aue-sya.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/azureDIY",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 6,
				"cores": 4,
				"memory": 28,
				"automaticScaleJobs": false
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true,
					"tags": [
						"parameters"
					]
				},
				"source": [
					"account_name = \"azurediyauedls\"\r\n",
					"sourcezone = \"raw\"\r\n",
					"sourcepath = \"CSSEGISandData\"\r\n",
					"sourcename = \"/UID_ISO_FIPS_LookUp_Table.csv\"\r\n",
					"targetzone = \"trusted\"\r\n",
					"targetpath = \"refined\"\r\n",
					"targetname = \"CountryCodes\""
				],
				"execution_count": 13
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"\r\n",
					"#connect to raw zone\r\n",
					"#account_name = \"azurediyauedls\"\r\n",
					"#container_name = \"raw\"\r\n",
					"#relative_path = path\r\n",
					"adls_path = 'abfss://%s@%s.dfs.core.windows.net/%s' % (sourcezone, account_name, sourcepath)\r\n",
					""
				],
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"tags": []
				},
				"source": [
					"\r\n",
					"countryCodeDF = spark.read.option('header', 'true') \\\r\n",
					"                .option('delimiter', ',') \\\r\n",
					"                .csv(adls_path + filename)"
				],
				"execution_count": 15
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"countrycodeiso3= countryCodeDF.select(\"iso3\",\"Country_Region\").distinct()\r\n",
					"display(countrycodeiso3)"
				],
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"#write to trusted zone\r\n",
					"target_folder_path =  'abfss://'+targetzone+'@'+account_name+'.dfs.core.windows.net/'+targetpath+'/'+targetname+'/'\r\n",
					"\r\n",
					"#adls_target_path = 'abfss://%s@%s.dfs.core.windows.net/%s' % (targetzone, account_name, targetpath)\r\n",
					"\r\n",
					"countrycodeiso3.write.format(\"parquet\").save(target_folder_path)"
				],
				"execution_count": 19
			}
		]
	}
}