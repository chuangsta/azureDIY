{
	"name": "LatestDoctorCounts",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "AzureDIY",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"7aeb1fc3-ff82-4e4d-9e9d-0774c86fcd35": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"COUNTRY": "NIU",
										"YEAR": 2008,
										"DoctorsPer10k": 23.529
									},
									{
										"COUNTRY": "HTI",
										"YEAR": 2018,
										"DoctorsPer10k": 2.384
									},
									{
										"COUNTRY": "BRB",
										"YEAR": 2017,
										"DoctorsPer10k": 24.843
									},
									{
										"COUNTRY": "LVA",
										"YEAR": 2017,
										"DoctorsPer10k": 46.934
									},
									{
										"COUNTRY": "POL",
										"YEAR": 2017,
										"DoctorsPer10k": 24.188
									},
									{
										"COUNTRY": "ZMB",
										"YEAR": 2018,
										"DoctorsPer10k": 11.867
									},
									{
										"COUNTRY": "JAM",
										"YEAR": 2017,
										"DoctorsPer10k": 13.061
									},
									{
										"COUNTRY": "BRA",
										"YEAR": 2018,
										"DoctorsPer10k": 21.652
									},
									{
										"COUNTRY": "ARM",
										"YEAR": 2017,
										"DoctorsPer10k": 44.023
									},
									{
										"COUNTRY": "MOZ",
										"YEAR": 2018,
										"DoctorsPer10k": 0.838
									},
									{
										"COUNTRY": "CUB",
										"YEAR": 2018,
										"DoctorsPer10k": 84.218
									},
									{
										"COUNTRY": "JOR",
										"YEAR": 2017,
										"DoctorsPer10k": 28.078
									},
									{
										"COUNTRY": "SOM",
										"YEAR": 2014,
										"DoctorsPer10k": 0.279
									},
									{
										"COUNTRY": "FRA",
										"YEAR": 2018,
										"DoctorsPer10k": 34.41
									},
									{
										"COUNTRY": "COD",
										"YEAR": 2016,
										"DoctorsPer10k": 0.934
									},
									{
										"COUNTRY": "BRN",
										"YEAR": 2017,
										"DoctorsPer10k": 17.812
									},
									{
										"COUNTRY": "FSM",
										"YEAR": 2009,
										"DoctorsPer10k": 6.184
									},
									{
										"COUNTRY": "BOL",
										"YEAR": 2016,
										"DoctorsPer10k": 15.901
									},
									{
										"COUNTRY": "URY",
										"YEAR": 2017,
										"DoctorsPer10k": 50.794
									},
									{
										"COUNTRY": "LBY",
										"YEAR": 2017,
										"DoctorsPer10k": 20.905
									},
									{
										"COUNTRY": "ETH",
										"YEAR": 2018,
										"DoctorsPer10k": 0.986
									},
									{
										"COUNTRY": "ATG",
										"YEAR": 2017,
										"DoctorsPer10k": 29.56
									},
									{
										"COUNTRY": "GNQ",
										"YEAR": 2017,
										"DoctorsPer10k": 4.017
									},
									{
										"COUNTRY": "ITA",
										"YEAR": 2018,
										"DoctorsPer10k": 59.882
									},
									{
										"COUNTRY": "UKR",
										"YEAR": 2014,
										"DoctorsPer10k": 34.965
									},
									{
										"COUNTRY": "CMR",
										"YEAR": 2011,
										"DoctorsPer10k": 1.81
									},
									{
										"COUNTRY": "GHA",
										"YEAR": 2017,
										"DoctorsPer10k": 1.523
									},
									{
										"COUNTRY": "NER",
										"YEAR": 2016,
										"DoctorsPer10k": 0.511
									},
									{
										"COUNTRY": "SEN",
										"YEAR": 2017,
										"DoctorsPer10k": 3.179
									},
									{
										"COUNTRY": "GTM",
										"YEAR": 2018,
										"DoctorsPer10k": 9.039
									},
									{
										"COUNTRY": "COM",
										"YEAR": 2016,
										"DoctorsPer10k": 2.715
									},
									{
										"COUNTRY": "GUY",
										"YEAR": 2018,
										"DoctorsPer10k": 8.023
									},
									{
										"COUNTRY": "LCA",
										"YEAR": 2017,
										"DoctorsPer10k": 26.809
									},
									{
										"COUNTRY": "VCT",
										"YEAR": 2010,
										"DoctorsPer10k": 9.361
									},
									{
										"COUNTRY": "HRV",
										"YEAR": 2016,
										"DoctorsPer10k": 31.728
									},
									{
										"COUNTRY": "QAT",
										"YEAR": 2018,
										"DoctorsPer10k": 37.273
									},
									{
										"COUNTRY": "BHS",
										"YEAR": 2017,
										"DoctorsPer10k": 27.553
									},
									{
										"COUNTRY": "GBR",
										"YEAR": 2018,
										"DoctorsPer10k": 28.117
									},
									{
										"COUNTRY": "GMB",
										"YEAR": 2015,
										"DoctorsPer10k": 1.109
									},
									{
										"COUNTRY": "PRY",
										"YEAR": 2018,
										"DoctorsPer10k": 13.544
									},
									{
										"COUNTRY": "ARE",
										"YEAR": 2018,
										"DoctorsPer10k": 25.278
									},
									{
										"COUNTRY": "TON",
										"YEAR": 2013,
										"DoctorsPer10k": 5.967
									},
									{
										"COUNTRY": "CRI",
										"YEAR": 2018,
										"DoctorsPer10k": 29.533
									},
									{
										"COUNTRY": "TJK",
										"YEAR": 2014,
										"DoctorsPer10k": 28.77
									},
									{
										"COUNTRY": "ERI",
										"YEAR": 2016,
										"DoctorsPer10k": 0.79
									},
									{
										"COUNTRY": "NPL",
										"YEAR": 2018,
										"DoctorsPer10k": 9.101
									},
									{
										"COUNTRY": "UGA",
										"YEAR": 2017,
										"DoctorsPer10k": 1.68
									},
									{
										"COUNTRY": "VUT",
										"YEAR": 2016,
										"DoctorsPer10k": 1.844
									},
									{
										"COUNTRY": "AZE",
										"YEAR": 2014,
										"DoctorsPer10k": 38.232
									},
									{
										"COUNTRY": "MLI",
										"YEAR": 2018,
										"DoctorsPer10k": 1.395
									},
									{
										"COUNTRY": "AUS",
										"YEAR": 2017,
										"DoctorsPer10k": 36.778
									},
									{
										"COUNTRY": "KNA",
										"YEAR": 2015,
										"DoctorsPer10k": 26.758
									},
									{
										"COUNTRY": "MLT",
										"YEAR": 2015,
										"DoctorsPer10k": 33.553
									},
									{
										"COUNTRY": "MEX",
										"YEAR": 2017,
										"DoctorsPer10k": 23.827
									},
									{
										"COUNTRY": "DMA",
										"YEAR": 2017,
										"DoctorsPer10k": 17.791
									},
									{
										"COUNTRY": "AFG",
										"YEAR": 2016,
										"DoctorsPer10k": 2.983
									},
									{
										"COUNTRY": "BGD",
										"YEAR": 2018,
										"DoctorsPer10k": 5.809
									},
									{
										"COUNTRY": "PNG",
										"YEAR": 2018,
										"DoctorsPer10k": 0.699
									},
									{
										"COUNTRY": "YEM",
										"YEAR": 2014,
										"DoctorsPer10k": 5.251
									},
									{
										"COUNTRY": "BLR",
										"YEAR": 2015,
										"DoctorsPer10k": 51.905
									},
									{
										"COUNTRY": "MNG",
										"YEAR": 2016,
										"DoctorsPer10k": 32.194
									},
									{
										"COUNTRY": "SYC",
										"YEAR": 2016,
										"DoctorsPer10k": 21.212
									},
									{
										"COUNTRY": "SVK",
										"YEAR": 2017,
										"DoctorsPer10k": 34.664
									},
									{
										"COUNTRY": "STP",
										"YEAR": 2017,
										"DoctorsPer10k": 5.27
									},
									{
										"COUNTRY": "COG",
										"YEAR": 2011,
										"DoctorsPer10k": 7.301
									},
									{
										"COUNTRY": "HUN",
										"YEAR": 2018,
										"DoctorsPer10k": 37.708
									},
									{
										"COUNTRY": "TKM",
										"YEAR": 2014,
										"DoctorsPer10k": 70.946
									},
									{
										"COUNTRY": "NZL",
										"YEAR": 2018,
										"DoctorsPer10k": 35.898
									},
									{
										"COUNTRY": "DJI",
										"YEAR": 2014,
										"DoctorsPer10k": 2.328
									},
									{
										"COUNTRY": "THA",
										"YEAR": 2018,
										"DoctorsPer10k": 8.075
									},
									{
										"COUNTRY": "IRQ",
										"YEAR": 2018,
										"DoctorsPer10k": 10.364
									},
									{
										"COUNTRY": "NOR",
										"YEAR": 2018,
										"DoctorsPer10k": 29.164
									},
									{
										"COUNTRY": "VEN",
										"YEAR": 2001,
										"DoctorsPer10k": 19.475
									},
									{
										"COUNTRY": "TUV",
										"YEAR": 2014,
										"DoctorsPer10k": 11.524
									},
									{
										"COUNTRY": "GNB",
										"YEAR": 2016,
										"DoctorsPer10k": 2.038
									},
									{
										"COUNTRY": "TLS",
										"YEAR": 2018,
										"DoctorsPer10k": 7.504
									},
									{
										"COUNTRY": "BWA",
										"YEAR": 2016,
										"DoctorsPer10k": 5.269
									},
									{
										"COUNTRY": "SAU",
										"YEAR": 2018,
										"DoctorsPer10k": 26.117
									},
									{
										"COUNTRY": "FIN",
										"YEAR": 2016,
										"DoctorsPer10k": 38.118
									},
									{
										"COUNTRY": "BFA",
										"YEAR": 2017,
										"DoctorsPer10k": 0.847
									},
									{
										"COUNTRY": "DOM",
										"YEAR": 2011,
										"DoctorsPer10k": 18.498
									},
									{
										"COUNTRY": "TGO",
										"YEAR": 2018,
										"DoctorsPer10k": 2.554
									},
									{
										"COUNTRY": "ALB",
										"YEAR": 2016,
										"DoctorsPer10k": 16.217
									},
									{
										"COUNTRY": "BHR",
										"YEAR": 2015,
										"DoctorsPer10k": 10.774
									},
									{
										"COUNTRY": "NIC",
										"YEAR": 2018,
										"DoctorsPer10k": 9.895
									},
									{
										"COUNTRY": "SUR",
										"YEAR": 2018,
										"DoctorsPer10k": 12.101
									},
									{
										"COUNTRY": "BIH",
										"YEAR": 2015,
										"DoctorsPer10k": 21.616
									},
									{
										"COUNTRY": "KWT",
										"YEAR": 2015,
										"DoctorsPer10k": 26.522
									},
									{
										"COUNTRY": "MWI",
										"YEAR": 2018,
										"DoctorsPer10k": 0.358
									},
									{
										"COUNTRY": "FJI",
										"YEAR": 2015,
										"DoctorsPer10k": 8.6
									},
									{
										"COUNTRY": "MRT",
										"YEAR": 2018,
										"DoctorsPer10k": 1.865
									},
									{
										"COUNTRY": "AND",
										"YEAR": 2015,
										"DoctorsPer10k": 33.333
									},
									{
										"COUNTRY": "CAF",
										"YEAR": 2015,
										"DoctorsPer10k": 0.836
									},
									{
										"COUNTRY": "PER",
										"YEAR": 2016,
										"DoctorsPer10k": 16.648
									},
									{
										"COUNTRY": "NLD",
										"YEAR": 2017,
										"DoctorsPer10k": 36.054
									},
									{
										"COUNTRY": "PAK",
										"YEAR": 2018,
										"DoctorsPer10k": 10.005
									},
									{
										"COUNTRY": "LUX",
										"YEAR": 2017,
										"DoctorsPer10k": 30.09
									},
									{
										"COUNTRY": "TUR",
										"YEAR": 2017,
										"DoctorsPer10k": 18.492
									},
									{
										"COUNTRY": "RWA",
										"YEAR": 2018,
										"DoctorsPer10k": 1.371
									},
									{
										"COUNTRY": "SLE",
										"YEAR": 2011,
										"DoctorsPer10k": 0.309
									},
									{
										"COUNTRY": "MNE",
										"YEAR": 2018,
										"DoctorsPer10k": 27.557
									},
									{
										"COUNTRY": "BDI",
										"YEAR": 2017,
										"DoctorsPer10k": 1.001
									},
									{
										"COUNTRY": "CPV",
										"YEAR": 2015,
										"DoctorsPer10k": 7.814
									},
									{
										"COUNTRY": "AUT",
										"YEAR": 2017,
										"DoctorsPer10k": 51.697
									},
									{
										"COUNTRY": "USA",
										"YEAR": 2017,
										"DoctorsPer10k": 27.147
									},
									{
										"COUNTRY": "MDG",
										"YEAR": 2014,
										"DoctorsPer10k": 1.953
									},
									{
										"COUNTRY": "MAR",
										"YEAR": 2017,
										"DoctorsPer10k": 9.135
									},
									{
										"COUNTRY": "SDN",
										"YEAR": 2017,
										"DoctorsPer10k": 4.073
									},
									{
										"COUNTRY": "OMN",
										"YEAR": 2018,
										"DoctorsPer10k": 21.481
									},
									{
										"COUNTRY": "GEO",
										"YEAR": 2018,
										"DoctorsPer10k": 71.201
									},
									{
										"COUNTRY": "PAN",
										"YEAR": 2016,
										"DoctorsPer10k": 15.979
									},
									{
										"COUNTRY": "VNM",
										"YEAR": 2016,
										"DoctorsPer10k": 8.281
									},
									{
										"COUNTRY": "CIV",
										"YEAR": 2014,
										"DoctorsPer10k": 2.314
									},
									{
										"COUNTRY": "LBR",
										"YEAR": 2015,
										"DoctorsPer10k": 0.376
									},
									{
										"COUNTRY": "PRK",
										"YEAR": 2017,
										"DoctorsPer10k": 37.011
									},
									{
										"COUNTRY": "KOR",
										"YEAR": 2017,
										"DoctorsPer10k": 23.608
									},
									{
										"COUNTRY": "LSO",
										"YEAR": 2010,
										"DoctorsPer10k": 0.692
									},
									{
										"COUNTRY": "ZAF",
										"YEAR": 2017,
										"DoctorsPer10k": 9.054
									},
									{
										"COUNTRY": "BTN",
										"YEAR": 2018,
										"DoctorsPer10k": 4.242
									},
									{
										"COUNTRY": "ISR",
										"YEAR": 2018,
										"DoctorsPer10k": 46.249
									},
									{
										"COUNTRY": "PRT",
										"YEAR": 2017,
										"DoctorsPer10k": 51.24
									},
									{
										"COUNTRY": "NAM",
										"YEAR": 2018,
										"DoctorsPer10k": 5.914
									},
									{
										"COUNTRY": "TUN",
										"YEAR": 2017,
										"DoctorsPer10k": 13.3
									},
									{
										"COUNTRY": "SMR",
										"YEAR": 2014,
										"DoctorsPer10k": 61.094
									},
									{
										"COUNTRY": "IRN",
										"YEAR": 2018,
										"DoctorsPer10k": 15.844
									},
									{
										"COUNTRY": "LTU",
										"YEAR": 2018,
										"DoctorsPer10k": 63.528
									},
									{
										"COUNTRY": "CYP",
										"YEAR": 2016,
										"DoctorsPer10k": 26.236
									},
									{
										"COUNTRY": "ZWE",
										"YEAR": 2018,
										"DoctorsPer10k": 2.096
									},
									{
										"COUNTRY": "MYS",
										"YEAR": 2015,
										"DoctorsPer10k": 15.358
									},
									{
										"COUNTRY": "CHL",
										"YEAR": 2018,
										"DoctorsPer10k": 25.912
									},
									{
										"COUNTRY": "MHL",
										"YEAR": 2012,
										"DoctorsPer10k": 5.841
									},
									{
										"COUNTRY": "MUS",
										"YEAR": 2018,
										"DoctorsPer10k": 25.331
									},
									{
										"COUNTRY": "CAN",
										"YEAR": 2016,
										"DoctorsPer10k": 23.105
									},
									{
										"COUNTRY": "COL",
										"YEAR": 2018,
										"DoctorsPer10k": 21.848
									},
									{
										"COUNTRY": "RUS",
										"YEAR": 2015,
										"DoctorsPer10k": 45.231
									},
									{
										"COUNTRY": "ROU",
										"YEAR": 2017,
										"DoctorsPer10k": 29.807
									},
									{
										"COUNTRY": "KIR",
										"YEAR": 2013,
										"DoctorsPer10k": 3.984
									},
									{
										"COUNTRY": "ARG",
										"YEAR": 2017,
										"DoctorsPer10k": 40.013
									},
									{
										"COUNTRY": "BLZ",
										"YEAR": 2017,
										"DoctorsPer10k": 11.45
									},
									{
										"COUNTRY": "SWZ",
										"YEAR": 2016,
										"DoctorsPer10k": 3.285
									},
									{
										"COUNTRY": "DNK",
										"YEAR": 2016,
										"DoctorsPer10k": 40.099
									},
									{
										"COUNTRY": "TTO",
										"YEAR": 2018,
										"DoctorsPer10k": 41.675
									},
									{
										"COUNTRY": "ESP",
										"YEAR": 2017,
										"DoctorsPer10k": 40.88
									},
									{
										"COUNTRY": "KEN",
										"YEAR": 2018,
										"DoctorsPer10k": 1.959
									},
									{
										"COUNTRY": "LKA",
										"YEAR": 2018,
										"DoctorsPer10k": 10.041
									},
									{
										"COUNTRY": "WSM",
										"YEAR": 2016,
										"DoctorsPer10k": 6.912
									},
									{
										"COUNTRY": "MDV",
										"YEAR": 2018,
										"DoctorsPer10k": 45.627
									},
									{
										"COUNTRY": "LBN",
										"YEAR": 2018,
										"DoctorsPer10k": 28.827
									},
									{
										"COUNTRY": "EST",
										"YEAR": 2018,
										"DoctorsPer10k": 44.833
									},
									{
										"COUNTRY": "AGO",
										"YEAR": 2017,
										"DoctorsPer10k": 2.146
									},
									{
										"COUNTRY": "SLB",
										"YEAR": 2016,
										"DoctorsPer10k": 2.013
									},
									{
										"COUNTRY": "IRL",
										"YEAR": 2018,
										"DoctorsPer10k": 41.326
									},
									{
										"COUNTRY": "SWE",
										"YEAR": 2016,
										"DoctorsPer10k": 42.856
									},
									{
										"COUNTRY": "GAB",
										"YEAR": 2017,
										"DoctorsPer10k": 6.819
									},
									{
										"COUNTRY": "NGA",
										"YEAR": 2018,
										"DoctorsPer10k": 4.494
									},
									{
										"COUNTRY": "HND",
										"YEAR": 2017,
										"DoctorsPer10k": 9.839
									},
									{
										"COUNTRY": "SVN",
										"YEAR": 2017,
										"DoctorsPer10k": 30.861
									},
									{
										"COUNTRY": "NRU",
										"YEAR": 2015,
										"DoctorsPer10k": 15.094
									},
									{
										"COUNTRY": "SLV",
										"YEAR": 2016,
										"DoctorsPer10k": 18.823
									},
									{
										"COUNTRY": "ECU",
										"YEAR": 2016,
										"DoctorsPer10k": 21.111
									},
									{
										"COUNTRY": "GRD",
										"YEAR": 2017,
										"DoctorsPer10k": 14.067
									},
									{
										"COUNTRY": "SYR",
										"YEAR": 2016,
										"DoctorsPer10k": 15.513
									},
									{
										"COUNTRY": "GRC",
										"YEAR": 2017,
										"DoctorsPer10k": 54.789
									},
									{
										"COUNTRY": "GIN",
										"YEAR": 2016,
										"DoctorsPer10k": 1.106
									},
									{
										"COUNTRY": "COK",
										"YEAR": 2014,
										"DoctorsPer10k": 14.124
									},
									{
										"COUNTRY": "SGP",
										"YEAR": 2016,
										"DoctorsPer10k": 22.936
									},
									{
										"COUNTRY": "KAZ",
										"YEAR": 2014,
										"DoctorsPer10k": 40.668
									},
									{
										"COUNTRY": "IND",
										"YEAR": 2018,
										"DoctorsPer10k": 12.208
									},
									{
										"COUNTRY": "TCD",
										"YEAR": 2017,
										"DoctorsPer10k": 0.493
									},
									{
										"COUNTRY": "MMR",
										"YEAR": 2018,
										"DoctorsPer10k": 8.638
									},
									{
										"COUNTRY": "KHM",
										"YEAR": 2014,
										"DoctorsPer10k": 4.758
									},
									{
										"COUNTRY": "BEL",
										"YEAR": 2017,
										"DoctorsPer10k": 30.709
									},
									{
										"COUNTRY": "MKD",
										"YEAR": 2015,
										"DoctorsPer10k": 28.736
									},
									{
										"COUNTRY": "IDN",
										"YEAR": 2018,
										"DoctorsPer10k": 4.269
									},
									{
										"COUNTRY": "CHN",
										"YEAR": 2017,
										"DoctorsPer10k": 19.798
									},
									{
										"COUNTRY": "DZA",
										"YEAR": 2018,
										"DoctorsPer10k": 18.325
									},
									{
										"COUNTRY": "DEU",
										"YEAR": 2017,
										"DoctorsPer10k": 42.488
									},
									{
										"COUNTRY": "MDA",
										"YEAR": 2017,
										"DoctorsPer10k": 36.662
									},
									{
										"COUNTRY": "BGR",
										"YEAR": 2015,
										"DoctorsPer10k": 40.332
									},
									{
										"COUNTRY": "UZB",
										"YEAR": 2014,
										"DoctorsPer10k": 33.911
									},
									{
										"COUNTRY": "MCO",
										"YEAR": 2014,
										"DoctorsPer10k": 77.778
									},
									{
										"COUNTRY": "JPN",
										"YEAR": 2016,
										"DoctorsPer10k": 24.115
									},
									{
										"COUNTRY": "SRB",
										"YEAR": 2016,
										"DoctorsPer10k": 31.131
									},
									{
										"COUNTRY": "TZA",
										"YEAR": 2016,
										"DoctorsPer10k": 0.603
									},
									{
										"COUNTRY": "KGZ",
										"YEAR": 2014,
										"DoctorsPer10k": 34.741
									},
									{
										"COUNTRY": "LAO",
										"YEAR": 2017,
										"DoctorsPer10k": 7.809
									},
									{
										"COUNTRY": "PLW",
										"YEAR": 2014,
										"DoctorsPer10k": 16.111
									},
									{
										"COUNTRY": "CHE",
										"YEAR": 2017,
										"DoctorsPer10k": 42.957
									},
									{
										"COUNTRY": "CZE",
										"YEAR": 2018,
										"DoctorsPer10k": 41.208
									},
									{
										"COUNTRY": "PHL",
										"YEAR": 2017,
										"DoctorsPer10k": 12.717
									},
									{
										"COUNTRY": "BEN",
										"YEAR": 2018,
										"DoctorsPer10k": 1.849
									},
									{
										"COUNTRY": "EGY",
										"YEAR": 2018,
										"DoctorsPer10k": 11.38
									},
									{
										"COUNTRY": "ISL",
										"YEAR": 2018,
										"DoctorsPer10k": 40.778
									}
								],
								"schema": {
									"COUNTRY": "string",
									"YEAR": "int",
									"DoctorsPer10k": "double"
								}
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"COUNTRY"
									],
									"seriesFieldKeys": [
										"YEAR"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/6f6081c0-3ae8-4f30-a576-96e46665aa5a/resourceGroups/azureDIY-aue-RG/providers/Microsoft.Synapse/workspaces/azurediy-aue-apu/bigDataPools/AzureDIY",
				"name": "AzureDIY",
				"type": "Spark",
				"endpoint": "https://azurediy-aue-apu.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/AzureDIY",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"automaticScaleJobs": false
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true,
					"tags": [
						"parameters"
					]
				},
				"source": [
					"account_name = \"azurediyaueadls\"\r\n",
					"sourcezone = \"raw\"\r\n",
					"sourcepath = \"GHODoctors\"\r\n",
					"sourcename = \"/LatestDoctorCounts.csv\"\r\n",
					"targetzone = \"trusted\"\r\n",
					"targetpath = \"refined\"\r\n",
					"targetname = \"LatestDoctorCounts\""
				],
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"\r\n",
					"#connect to raw zone\r\n",
					"#account_name = \"azurediyauedls\"\r\n",
					"#container_name = \"raw\"\r\n",
					"#relative_path = path\r\n",
					"adls_path = 'abfss://%s@%s.dfs.core.windows.net/%s' % (sourcezone, account_name, sourcepath)"
				],
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"source": [
					"doctorDF = spark.read.option('inferSchema', 'true') \\\r\n",
					"                .option('delimiter', ',') \\\r\n",
					"                .csv(adls_path + sourcename)"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"doctorSelect = doctorDF.select(\"_c3\",\"_c5\",\"_c15\")\r\n",
					"doctorLatest = doctorSelect.groupBy(\"_c3\").max(\"_c5\",\"_c15\")\r\n",
					"doctorLatest = doctorLatest.withColumnRenamed(\"_c3\",'COUNTRY').withColumnRenamed(\"max(_c5)\",'YEAR').withColumnRenamed(\"max(_c15)\",'DoctorsPer10k')\r\n",
					"display(doctorLatest)"
				],
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					""
				],
				"execution_count": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"#write to trusted zone\r\n",
					"\r\n",
					"target_folder_path =  'abfss://'+targetzone+'@'+account_name+'.dfs.core.windows.net/'+targetpath+'/'+targetname+'/'\r\n",
					"\r\n",
					"#adls_target_path = 'abfss://%s@%s.dfs.core.windows.net/%s' % (targetzone, account_name, targetpath)\r\n",
					"\r\n",
					"doctorLatest.write.mode(\"overwrite\").format(\"parquet\").save(target_folder_path)"
				],
				"execution_count": 7
			}
		]
	}
}